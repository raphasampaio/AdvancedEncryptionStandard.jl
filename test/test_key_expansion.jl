module TestKeyExpansion

using Test

import AdvancedEncryptionStandard as AES

@testset "Key Expansion" begin
    expanded_key = [
        0x594f5552, 0x45574249, 0x4c204d4e, 0x4c534145,
        0x632c792b, 0x6a3d7f36, 0x22024f01, 0x4c1f5e1b,
        0x6448311a, 0x162b5462, 0x8d8fc0c1, 0xbda2fce7,
        0xca82b3a9, 0x6e451173, 0x19965697, 0x1fbd41a6,
        0x4dcf7cd5, 0xe6a3b2c1, 0x3dabfd6a, 0xcc713096,
        0x25ea9643, 0xe447f534, 0xad06fb91, 0xcfbe8e18,
        0x1df76122, 0x6522d7e3, 0x0006fd6c, 0xd56be5fd,
        0x4cbbdaf8, 0x3517c023, 0x5452afc3, 0x462dc835,
        0xea518b73, 0x1b0cccef, 0xc2903ffc, 0x072ae2d7,
        0x2e7ff487, 0xaba76b84, 0xcc5c639f, 0x88a24097,
        0x4738cc4b, 0x70d7bc38, 0x44187be4, 0x9f3d7dea,
    ]

    @test AES.key_expansion("YELLOW SUBMARINE") == expanded_key

    expanded_key = [
        0x504c4949, 0x55454443, 0x5220454b, 0x50534b53,
        0x4b074e07, 0xe6a3e7a4, 0xbf9fda91, 0x6b387320,
        0x0007494e, 0x67c42387, 0x08974ddc, 0xae96e5c5,
        0x13145d13, 0xe1250681, 0xae3974a8, 0x8117f237,
        0x17035e4d, 0x23060081, 0x340d79d1, 0xfceb192e,
        0x0b08561b, 0x1d1b1b9a, 0x050871a0, 0x1ff4edc3,
        0x939bcdd6, 0xfde6fd67, 0x2b2352f2, 0xb044a96a,
        0x56cd00d6, 0x74926f08, 0x290a58aa, 0x4602abc1,
        0xe62b2bfd, 0xd84a252d, 0x515b03a9, 0xb0b219d8,
        0x250e25d8, 0x0b416449, 0x306b68c1, 0xe4564f97,
        0x282603db, 0x7332561f, 0xb8d3bb7a, 0x85d39c0b,
    ]

    @test AES.key_expansion("PURPLE SIDEKICKS") == expanded_key
end
end
